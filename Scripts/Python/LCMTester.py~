import os
import argparse
from subprocess import call
import logging

## Reading arguments...
parser = argparse.ArgumentParser()
parser.add_argument("--input_file", "-i", required=True,      help="Input file...")
parser.add_argument("--master",     "-m", default="local[*]", help="Master...")
parser.add_argument("--partitions", "-p", default=1,          help="Partitions...")
parser.add_argument("--cores",      "-c", default=1,          help="Cores...")
parser.add_argument("--debug",      "-d", default=False,      help="Activate debug mode.")
args = parser.parse_args()
logging.basicConfig(format="%(asctime)s -> %(message)s")

start = d.now()
logging.info("Starting...")
input_file    = args.input_file
partitions    = args.partitions
cores         = args.cores
jar_file      = "/home/acald013/Research/PFlock/target/scala-2.11/pflock_2.11-2.0.jar"
jar_class     = "--class SPMF.ScalaLCM.Tester"
command       = "{} {} {} --input {} --master {} --partitions {} --cores {}".format('spark-submit', jar_class, jar_file, input_file, master, partitions, cores)
if(debug):
    print(command)
    call([command], shell=True)
logging.info("It is done!")
